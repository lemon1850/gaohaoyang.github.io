---
layout: post
title: mq面试
categories: 面试
tags:  面试
---

* content
{:toc}

> 我的技术博客，主要是记载看过的书以及对写的好的博客文章的搬运整理，方便自己他人查看，也方便别人指出我文章中的错误，达到一起学习的目的。
> 技术永无止境


kafka了解？
rocketmq事务性消息如何实现

事务提交的消息丢了，没有发到broker上面，怎么处理

https://www.jianshu.com/p/453c6e7ff81c

#### 消息的顺序性

需要保证跟一次处理相关的所有消息都应该发送到同一个队列上，而同一个队列的消息应该要同一个消费者消费，因此有生产者:队列:消费者=1:1:1

#### 消息的重复问题

由于网络异常，消息确认信息丢失等原因，可能存在消息重复消费, 处理方法
1. 消费者处理消息的业务逻辑保证幂等性
2. 保证每条消息都有唯一编号，且有去重表存储已经消费过的消息。

#### 消息队列发送消息失败

需要消息重复机制，如果消息发送失败，存储到数据库，存储到数据库，定时程序尝试重试或者人工触发重发。


为啥需要消息队列呢？

1. 我不想系统太紧耦合
2. 通过消息队列可以把同步调用转化成异步
3. 可以削峰，防止突然流量

那我希望消息队列提供啥功能？

1. 我肯定希望我发送一连串有序的消息，能够有序被存储着，然后能被消费者有序消费，不让想下订单，再取消订单这些消息就会因为乱序乱套了。
2. 然后呢我肯定希望消息队列要可靠，那么肯定需要多副本，那样子挂了几台机器也没关系。
3. 可能上游发送某类消息，消息内容很多，那么单台机器必然不能承受，那样子我需要多台机器能存储这类消息，那么就像他支持分区的功能。
4. 肯定需要高性能，查询，写入性能好。如何保持高效IO呢。
5. 如何提供路由发现呢，怎么保证高可用呢

那从使用方，你会有啥考虑的地方吗？

1. 如果我发送消息到mq, 不可避免会有失败的情况，客户端是否有提供重试功能，或者我们手动重试，mq是否提供所谓的保证发送消息的唯一呢，根据发送消息的一个唯一标志，如一条消息已经成功了，重发具有相同标志的消息，是否提供做去重处理。
2. mq肯定由多台机器提供，如果特定分区的副本或者leader挂了，怎么故障转移。
3. 能否提供消费过滤功能呢


疑问？

如果长轮训模式实现准实时的消息推送模式？
定时消息有必要？
回溯消息？



